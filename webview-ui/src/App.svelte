<script lang="ts">
	import {
		provideVSCodeDesignSystem,
		vsCodeButton,
		vsCodeProgressRing,
		vsCodeTag,
    vsCodeTextField,
	} from "@vscode/webview-ui-toolkit";
	import { vscode } from "./utilities/vscode";
	import { onMount } from "svelte";
	import StateManager from "./utilities/stateManager";
	import type { IAssetMetadata, IFilterableAsset } from "./types/assetMetadata";
	import type { ITagFilter } from "./types/tagFilter";
	import { DefoldAssetsLoader } from "./utilities/defoldAssetsLoader";

	import "./css/global.css";

	let loading = true;
	let loadingProgress = 0;
	let assets: IFilterableAsset[];
	let tags: ITagFilter[];
  let value: string = '';

	provideVSCodeDesignSystem().register(
		vsCodeButton(),
		vsCodeProgressRing(),
		vsCodeTag(),
    vsCodeTextField(),
	);

	function addDependencyToProject(asset: IAssetMetadata) {
		vscode.postMessage({
			command: "add_dependency",
			text: JSON.stringify(asset),
		});
	}

	function copyFilesIntoProject(asset: IAssetMetadata) {
		vscode.postMessage({
			command: "copy_dependency",
			text: JSON.stringify(asset),
		});
	}

	function filterAssetsByTag(tag: ITagFilter) {
    // update selected tag
		tags = tags.map((t) => {
			t.selected = t.id === tag.id;
			return t;
		});
    // hide assets that don't match the tag
    assets = assets.map((asset) => {
      if (tag.id === 'all')
        asset.hidden = false;
      else
        asset.hidden = asset.tags.every(t => t.toLowerCase() !== tag.id);
      return asset;
    });
	}

  function filterAssetsByText(event) {
    const value = event.target.value.toLowerCase();
    assets = assets.map((asset) => {
      if (value === '')
        asset.hidden = false;
      else
        asset.hidden = asset.name.toLowerCase().indexOf(value) === -1 &&
          asset.description.toLowerCase().indexOf(value) === -1;
      return asset;
    });
  }

	async function loadAssets(): Promise<IAssetMetadata[]> {
		loading = true;
		try {
			const state = StateManager.load();
			if (state.assets.length > 0) {
				console.log("FROM CACHE", state.assets);
				return state.assets;
			}
			const loader = new DefoldAssetsLoader();
			const sub = loader.$loadProgress.subscribe((progress) => {
				loadingProgress = Math.round(progress * 100);
			});
			const assets = await loader.load();
			sub.unsubscribe();
			state.assets = assets;
			StateManager.save(state);
			return assets;
		} finally {
			loading = false;
		}
	}

	onMount(async () => {
		assets = await loadAssets();
		assets = assets.filter(skipNonAssets)
					.sort(sortByStarsDescending);
		tags = buildTagFilters(assets);
		console.log(tags);
	});

	function skipNonAssets(asset: IFilterableAsset): boolean {
		if (asset.library_url)
			return true;
		// skip non assets
		if (asset.tags.some((t) => t.toLowerCase() === 'tools' || t.toLowerCase() === 'editor' || t.toLowerCase() === 'tutorials'))
			return false;
		// skip if no github repo
		if (!asset.project_url.match(/github.com\/(?<author>[^\/]+)\/(?<repo>[^\/]+)/))
			return false;
		return true;
	}

	function sortByStarsDescending(a: IAssetMetadata, b: IAssetMetadata): number {
		if (a.stars > b.stars) return -1;
		if (a.stars < b.stars) return 1;
		return 0;
	}

	function buildTagFilters(assets: IAssetMetadata[]): ITagFilter[] {
    // build an index of unique tags with count
		const indexOfUniqueTagsWithCount = assets.reduce((res, asset) => {
			asset.tags.forEach((tag) => {
				const tagId = tag.toLocaleLowerCase();
				if (!res[tagId]) {
					res[tagId] = {
						id: tagId,
						name: tag,
						count: 1,
					};
				} else {
					res[tagId].count++;
				}
			});
			return res;
		}, new Map<string, ITagFilter>());
    // sort by name
		let tags = Object.values(indexOfUniqueTagsWithCount)
			.map(normalizeTagNames)
			.sort(sortByName);
    // add ALL tag
		tags.unshift({
			id: 'all',
			name: 'ALL',
			count: assets.length,
			selected: true,
		});
		return tags;
	}
	


function sortByName(a: any,b: any): number {
  return (a.name>b.name? 1:-1);
}

function normalizeTagNames(tag: ITagFilter): ITagFilter {
    if (tag.id === 'gui') tag.name = 'GUI';
    // capitalize first letter
    else tag.name = tag.name[0].toUpperCase() + tag.name.slice(1);
    return tag;
}
</script>

<main>
  {#if loading}
    <div class="loader">
      <vscode-progress-ring />
      <span>{loadingProgress} %</span>
    </div>
  {/if}

  <!-- Header -->
  <div class="header">
    <svg width="116px" height="92px" version="1.1" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
        <g id="Layer_15" transform="matrix(1,0,0,1,1.20076e-08,0.002318)">
            <path d="M104.21,22.48C104.393,22.782 104.493,23.127 104.5,23.48C104.499,23.216 104.55,22.954 104.65,22.71L104.21,22.48Z" style="fill:rgb(91,192,255);fill-opacity:0.2;fill-rule:nonzero;"/>
            <path d="M76.91,5.09C76.774,4.854 76.855,4.548 77.09,4.41L83.69,0.57C85.02,-0.193 86.66,-0.193 87.99,0.57L95.86,5.13C96.016,5.219 96.112,5.386 96.112,5.565C96.112,5.84 95.885,6.067 95.61,6.067C95.522,6.067 95.436,6.044 95.36,6L87.49,1.44C86.471,0.847 85.209,0.847 84.19,1.44L77.59,5.28C77.351,5.414 77.045,5.328 76.91,5.09ZM91.5,20.5C91.5,21.049 91.951,21.5 92.5,21.5C93.049,21.5 93.5,21.049 93.5,20.5C93.5,19.951 93.049,19.5 92.5,19.5C91.951,19.5 91.5,19.951 91.5,20.5ZM94.5,8.5C94.5,9.049 94.951,9.5 95.5,9.5C96.049,9.5 96.5,9.049 96.5,8.5C96.5,7.951 96.049,7.5 95.5,7.5C94.951,7.5 94.5,7.951 94.5,8.5ZM68,8.5C68,7.129 69.129,6 70.5,6C71.871,6 73,7.129 73,8.5C73,9.871 71.871,11 70.5,11C69.129,11 68,9.871 68,8.5ZM69,8.5C69,9.323 69.677,10 70.5,10C71.323,10 72,9.323 72,8.5C72,7.677 71.323,7 70.5,7C69.677,7 69,7.677 69,8.5ZM88.5,21.5C89.049,21.5 89.5,21.049 89.5,20.5C89.5,19.951 89.049,19.5 88.5,19.5C87.951,19.5 87.5,19.951 87.5,20.5C87.5,21.049 87.951,21.5 88.5,21.5ZM84.5,8.5C84.5,7.951 84.049,7.5 83.5,7.5C82.951,7.5 82.5,7.951 82.5,8.5C82.5,9.049 82.951,9.5 83.5,9.5C84.049,9.5 84.5,9.049 84.5,8.5ZM80.5,8.5C80.5,7.951 80.049,7.5 79.5,7.5C78.951,7.5 78.5,7.951 78.5,8.5C78.5,9.049 78.951,9.5 79.5,9.5C80.049,9.5 80.5,9.049 80.5,8.5ZM80.5,21.5C81.049,21.5 81.5,21.049 81.5,20.5C81.5,19.951 81.049,19.5 80.5,19.5C79.951,19.5 79.5,19.951 79.5,20.5C79.5,21.049 79.951,21.5 80.5,21.5ZM84.5,21.5C85.049,21.5 85.5,21.049 85.5,20.5C85.5,19.951 85.049,19.5 84.5,19.5C83.951,19.5 83.5,19.951 83.5,20.5C83.5,21.049 83.951,21.5 84.5,21.5ZM75.5,20.75C75.616,21.202 76.034,21.515 76.5,21.5C76.583,21.515 76.667,21.515 76.75,21.5C77.188,21.385 77.496,20.986 77.496,20.533C77.496,19.984 77.045,19.533 76.496,19.533C75.948,19.533 75.496,19.984 75.496,20.533C75.496,20.62 75.508,20.706 75.53,20.79L75.5,20.75ZM102.5,40.69C102.592,41.165 103.016,41.509 103.5,41.5L103.69,41.5C104.165,41.405 104.51,40.984 104.51,40.5C104.51,39.941 104.049,39.48 103.49,39.48C103.423,39.48 103.356,39.487 103.29,39.5C102.83,39.598 102.497,40.008 102.497,40.478C102.497,40.549 102.505,40.62 102.52,40.69L102.5,40.69ZM106.92,11.46C107.168,11.459 107.407,11.367 107.59,11.2C107.797,11.011 107.915,10.743 107.915,10.462C107.915,9.913 107.464,9.462 106.915,9.462C106.367,9.462 105.915,9.913 105.915,10.462C105.915,10.713 106.01,10.955 106.18,11.14C106.375,11.351 106.653,11.468 106.94,11.46L106.92,11.46ZM103.53,20.31C103.665,20.742 104.078,21.031 104.53,21.01C104.629,21.025 104.731,21.025 104.83,21.01C105.247,20.88 105.532,20.492 105.532,20.055C105.532,19.507 105.081,19.055 104.532,19.055C103.984,19.055 103.532,19.507 103.532,20.055C103.532,20.159 103.548,20.262 103.58,20.36L103.53,20.31ZM107.53,14.07C107.567,14.592 108.007,15.001 108.53,15L108.6,15C109.12,14.962 109.528,14.524 109.528,14.003C109.528,13.454 109.076,13.003 108.528,13.003C107.979,13.003 107.528,13.454 107.528,14.003C107.528,14.025 107.528,14.048 107.53,14.07ZM108.53,33.5C107.981,33.5 107.53,33.951 107.53,34.5C107.53,35.049 107.981,35.5 108.53,35.5C109.079,35.5 109.53,35.049 109.53,34.5C109.53,34.5 109.53,34.5 109.53,34.5C109.53,33.951 109.079,33.5 108.53,33.5C108.52,33.5 108.51,33.5 108.5,33.5L108.53,33.5ZM108.53,29.5C107.981,29.5 107.53,29.951 107.53,30.5C107.53,31.049 107.981,31.5 108.53,31.5C109.079,31.5 109.53,31.049 109.53,30.5C109.53,30.5 109.53,30.5 109.53,30.5C109.53,29.951 109.079,29.5 108.53,29.5C108.52,29.5 108.51,29.5 108.5,29.5L108.53,29.5ZM108.33,18.42C108.442,18.255 108.501,18.06 108.501,17.86C108.501,17.311 108.049,16.859 107.5,16.859C107.168,16.859 106.856,17.024 106.67,17.3C106.558,17.465 106.498,17.661 106.498,17.86C106.498,18.193 106.664,18.504 106.94,18.69C107.104,18.805 107.3,18.864 107.5,18.86C107.83,18.863 108.142,18.702 108.33,18.43L108.33,18.42ZM103.33,9.57L103.5,9.57C103.527,9.572 103.553,9.573 103.58,9.573C104.13,9.573 104.583,9.12 104.583,8.57C104.583,8.05 104.179,7.611 103.66,7.57C103.12,7.48 102.601,7.85 102.51,8.39C102.497,8.454 102.491,8.518 102.491,8.583C102.491,9.071 102.848,9.491 103.33,9.57ZM99.5,20.5C99.5,21.049 99.951,21.5 100.5,21.5C101.049,21.5 101.5,21.049 101.5,20.5C101.5,19.951 101.049,19.5 100.5,19.5C99.951,19.5 99.5,19.951 99.5,20.5ZM99.5,9.5C100.049,9.5 100.5,9.049 100.5,8.5C100.5,7.951 100.049,7.5 99.5,7.5C98.951,7.5 98.5,7.951 98.5,8.5C98.5,9.049 98.951,9.5 99.5,9.5ZM100.14,44.35C100.254,44.397 100.377,44.421 100.5,44.42C100.503,44.42 100.505,44.42 100.508,44.42C101.056,44.42 101.508,43.969 101.508,43.42C101.508,42.871 101.056,42.42 100.508,42.42C99.959,42.42 99.508,42.871 99.508,43.42C99.508,43.83 99.759,44.199 100.14,44.35ZM102.49,27.5C102.599,27.518 102.711,27.518 102.82,27.5C103.3,27.42 103.655,27 103.655,26.514C103.655,25.965 103.204,25.514 102.655,25.514C102.106,25.514 101.655,25.965 101.655,26.514C101.655,27 102.01,27.42 102.49,27.5ZM98.49,27.5C98.599,27.518 98.711,27.518 98.82,27.5C99.3,27.42 99.655,27 99.655,26.514C99.655,25.965 99.204,25.514 98.655,25.514C98.106,25.514 97.655,25.965 97.655,26.514C97.655,27 98.01,27.42 98.49,27.5ZM95.49,20.5C95.49,21.049 95.941,21.5 96.49,21.5C97.039,21.5 97.49,21.049 97.49,20.5C97.49,19.951 97.039,19.5 96.49,19.5C95.945,19.505 95.5,19.955 95.5,20.5L95.49,20.5ZM100.49,46.5C99.941,46.5 99.49,46.951 99.49,47.5C99.49,48.049 99.941,48.5 100.49,48.5C101.039,48.5 101.49,48.049 101.49,47.5C101.49,46.955 101.045,46.505 100.5,46.5L100.49,46.5ZM100.49,50.5C99.941,50.5 99.49,50.951 99.49,51.5C99.49,52.049 99.941,52.5 100.49,52.5C101.039,52.5 101.49,52.049 101.49,51.5C101.49,50.955 101.045,50.505 100.5,50.5L100.49,50.5ZM88.49,8.5C88.49,7.951 88.039,7.5 87.49,7.5C86.941,7.5 86.49,7.951 86.49,8.5C86.49,9.049 86.941,9.5 87.49,9.5C87.493,9.5 87.497,9.5 87.5,9.5C88.049,9.5 88.5,9.049 88.5,8.5C88.5,8.5 88.5,8.5 88.5,8.5L88.49,8.5ZM75.26,77.09C81.73,85.39 80.78,86.34 80.16,86.96C79.892,87.219 79.533,87.363 79.16,87.36C76.08,87.36 63.85,77.27 54.79,68.21C49.79,63.21 46.79,59.76 45.45,57.33C45.014,56.602 44.709,55.803 44.55,54.97L44.29,54.71L42,52.46L41.85,52.31C41.349,52.452 40.831,52.526 40.31,52.53C38.463,52.501 36.7,51.742 35.41,50.42C31.41,46.42 29.33,38.17 32.6,34.9C32.8,34.7 33.1,34.4 33.48,34.53C33.86,34.66 33.88,35.01 33.92,35.35C34.036,36.613 34.621,37.787 35.56,38.64C36.49,39.441 37.655,39.919 38.88,40C40.658,40.174 42.327,40.938 43.62,42.17C45.355,43.817 46.078,46.276 45.51,48.6L48.17,51.26C50.07,51.56 53.28,53.4 61.4,61.53C66.32,66.441 70.948,71.637 75.26,77.09ZM42,51L44.51,48.49C45.045,46.47 44.435,44.31 42.92,42.87C41.762,41.793 40.276,41.134 38.7,41C37.27,40.876 35.918,40.29 34.85,39.33C33.893,38.447 33.244,37.279 33,36C30.81,38.91 32.34,46 36.13,49.74C37.562,51.262 39.721,51.878 41.74,51.34L42,51ZM47.17,51.67L45,49.5L42.7,51.75L43.47,52.52L44.92,54L47.17,51.67ZM60.7,62.25C53.57,55.12 50.07,52.66 48.08,52.25L45.49,54.84C45.86,56.84 48.32,60.33 55.49,67.46C65.33,77.3 76.8,86.32 79.16,86.32C79.281,86.334 79.402,86.294 79.49,86.21C80.7,85 71.16,72.71 60.7,62.25ZM91.5,9.5C92.049,9.5 92.5,9.049 92.5,8.5C92.5,7.951 92.049,7.5 91.5,7.5C90.951,7.5 90.5,7.951 90.5,8.5C90.5,9.049 90.951,9.5 91.5,9.5ZM64.11,59.92C64.242,59.918 64.368,59.864 64.46,59.77L67.46,56.77C67.554,56.676 67.607,56.548 67.607,56.415C67.607,56.14 67.38,55.913 67.105,55.913C66.972,55.913 66.844,55.966 66.75,56.06L63.75,59.06C63.658,59.153 63.607,59.279 63.607,59.41C63.607,59.682 63.828,59.906 64.1,59.91L64.11,59.92ZM57.43,54.92C57.336,55.014 57.283,55.142 57.283,55.275C57.283,55.55 57.51,55.777 57.785,55.777C57.918,55.777 58.046,55.724 58.14,55.63L62.14,51.63C62.82,50.95 62.44,49.63 62.14,48.63L62.06,48.32C61.7,47.015 61.663,45.643 61.95,44.32C62.229,43.025 62.875,41.838 63.81,40.9L66.88,37.83C68.362,36.43 70.466,35.889 72.44,36.4L74,36.8L67.7,43.12C67.149,43.668 66.965,44.489 67.23,45.22L69,50.28C69.201,50.856 69.654,51.309 70.23,51.51L75.29,53.3C76.021,53.565 76.842,53.381 77.39,52.83L83.71,46.51L84.13,48.06C84.641,50.034 84.1,52.138 82.7,53.62L78.75,57.57C77.472,58.846 75.605,59.346 73.86,58.88L72.09,58.41C70.82,58.07 69.51,57.79 68.86,58.41L65.47,61.8C65.376,61.894 65.323,62.022 65.323,62.155C65.323,62.43 65.55,62.657 65.825,62.657C65.958,62.657 66.086,62.604 66.18,62.51L69.57,59.12C69.71,58.98 70.21,58.91 71.84,59.34L73.61,59.81C75.698,60.366 77.931,59.766 79.46,58.24L83.41,54.29C85.052,52.548 85.691,50.08 85.1,47.76L84.56,45.76C84.475,45.441 84.184,45.218 83.855,45.218C83.662,45.218 83.477,45.294 83.34,45.43L76.7,52.12C76.425,52.401 76.009,52.495 75.64,52.36L70.58,50.57C70.289,50.47 70.06,50.241 69.96,49.95L68.17,44.89C68.035,44.521 68.129,44.105 68.41,43.83L75.06,37.18C75.178,37.047 75.243,36.875 75.243,36.697C75.243,36.378 75.034,36.095 74.73,36L72.73,35.46C70.41,34.869 67.942,35.508 66.2,37.15L63.13,40.22C62.073,41.282 61.334,42.619 61,44.08C60.68,45.555 60.721,47.085 61.12,48.54L61.21,48.86C61.33,49.29 61.71,50.61 61.44,50.86L57.43,54.92ZM64.43,53.09C64.336,52.995 64.208,52.942 64.075,52.942C63.942,52.942 63.814,52.995 63.72,53.09L60.72,56.09C60.626,56.184 60.573,56.312 60.573,56.445C60.573,56.72 60.8,56.947 61.075,56.947C61.208,56.947 61.336,56.894 61.43,56.8L64.43,53.8C64.54,53.705 64.604,53.567 64.604,53.421C64.604,53.29 64.552,53.164 64.46,53.07L64.43,53.09ZM92.41,28.93C92.474,28.796 92.507,28.649 92.507,28.501C92.507,27.952 92.056,27.501 91.507,27.501C90.958,27.501 90.507,27.952 90.507,28.501C90.507,28.883 90.726,29.233 91.07,29.4C91.204,29.465 91.351,29.499 91.5,29.5C91.888,29.503 92.243,29.28 92.41,28.93ZM62.61,58.42C62.742,58.418 62.868,58.364 62.96,58.27L65.96,55.27C66.054,55.176 66.107,55.048 66.107,54.915C66.107,54.64 65.88,54.413 65.605,54.413C65.472,54.413 65.344,54.466 65.25,54.56L62.25,57.56C62.158,57.653 62.107,57.779 62.107,57.91C62.107,58.182 62.328,58.406 62.6,58.41L62.61,58.42ZM87.86,32.72L59.64,16.59C58.318,15.838 56.692,15.838 55.37,16.59L27.14,32.72C25.823,33.471 25.005,34.874 25,36.39L25,68.65C25.005,70.166 25.823,71.569 27.14,72.32L32.33,75.32C32.57,75.448 32.872,75.364 33.01,75.13C33.144,74.891 33.058,74.585 32.82,74.45L27.63,71.45C26.627,70.876 26.004,69.806 26,68.65L26,36.39C26.006,35.232 26.633,34.162 27.64,33.59L55.86,17.45C56.875,16.871 58.125,16.871 59.14,17.45L87.36,33.58C88.37,34.154 88.997,35.228 89,36.39L89,68.65C88.994,69.808 88.367,70.878 87.36,71.45L86.36,72L78.58,76.44C78.424,76.529 78.328,76.696 78.328,76.875C78.328,77.15 78.555,77.377 78.83,77.377C78.918,77.377 79.004,77.354 79.08,77.31L87,72.83L87.87,72.33C89.187,71.575 90.001,70.168 90,68.65L90,36.39C89.995,34.874 89.177,33.471 87.86,32.72ZM108.22,39.2C108.4,39.014 108.501,38.764 108.501,38.505C108.501,37.956 108.049,37.504 107.5,37.504C107.229,37.504 106.969,37.615 106.78,37.81C106.395,38.197 106.395,38.833 106.78,39.22C106.965,39.399 107.213,39.499 107.47,39.5C107.752,39.507 108.025,39.395 108.22,39.19L108.22,39.2ZM112.85,14.93L111.59,14.21C111.514,14.166 111.428,14.143 111.34,14.143C111.065,14.143 110.838,14.37 110.838,14.645C110.838,14.824 110.934,14.991 111.09,15.08L112.35,15.8C113.367,16.387 113.997,17.475 114,18.65L114,47.36C114.001,48.538 113.37,49.631 112.35,50.22L107.69,52.94C107.534,53.029 107.438,53.196 107.438,53.375C107.438,53.65 107.665,53.877 107.94,53.877C108.028,53.877 108.114,53.854 108.19,53.81L112.84,51.1C114.176,50.331 115.002,48.902 115,47.36L115,18.65C115,17.114 114.179,15.69 112.85,14.92L112.85,14.93ZM93.2,61.37L91.92,62.06C91.764,62.149 91.668,62.316 91.668,62.495C91.668,62.77 91.895,62.997 92.17,62.997C92.258,62.997 92.344,62.974 92.42,62.93L93.7,62.24C93.856,62.151 93.952,61.984 93.952,61.805C93.952,61.53 93.725,61.303 93.45,61.303C93.362,61.303 93.276,61.326 93.2,61.37ZM107.33,28C107.438,27.836 107.496,27.645 107.496,27.449C107.496,26.9 107.044,26.449 106.496,26.449C105.947,26.449 105.496,26.9 105.496,27.449C105.496,27.782 105.663,28.095 105.94,28.28C106.106,28.391 106.301,28.45 106.5,28.45C106.834,28.448 107.146,28.279 107.33,28ZM94.17,25.5C93.681,25.578 93.317,26.005 93.317,26.5C93.317,27.056 93.774,27.513 94.33,27.513C94.384,27.513 94.437,27.508 94.49,27.5C94.599,27.518 94.711,27.518 94.82,27.5C95.225,27.361 95.499,26.978 95.499,26.55C95.499,25.999 95.046,25.546 94.495,25.546C94.384,25.546 94.275,25.564 94.17,25.6L94.17,25.5ZM104.91,56.36L103.33,58L104.92,59.59C105.295,59.965 105.506,60.474 105.506,61.005C105.506,62.103 104.603,63.006 103.505,63.006C102.974,63.006 102.465,62.795 102.09,62.42L100.5,60.83L98.91,62.42C98.535,62.795 98.026,63.007 97.495,63.007C96.964,63.007 96.455,62.795 96.08,62.42C95.705,62.045 95.493,61.536 95.493,61.005C95.493,60.474 95.705,59.965 96.08,59.59L97.67,58L96.08,56.41C95.705,56.035 95.494,55.526 95.494,54.995C95.494,53.897 96.397,52.994 97.495,52.994C98.026,52.994 98.535,53.205 98.91,53.58L100.5,55.17L102.09,53.58C102.465,53.205 102.974,52.994 103.505,52.994C104.603,52.994 105.506,53.897 105.506,54.995C105.506,55.526 105.295,56.035 104.92,56.41L104.91,56.36ZM104.2,54.24C103.813,53.855 103.177,53.855 102.79,54.24L100.5,56.53L98.21,54.24C97.823,53.855 97.187,53.855 96.8,54.24C96.415,54.627 96.415,55.263 96.8,55.65L99.08,58L96.79,60.29C96.405,60.677 96.405,61.313 96.79,61.7C97.177,62.085 97.813,62.085 98.2,61.7L100.49,59.41L102.78,61.7C103.167,62.085 103.803,62.085 104.19,61.7C104.575,61.313 104.575,60.677 104.19,60.29L101.91,58L104.2,55.71C104.392,55.522 104.501,55.264 104.501,54.995C104.501,54.731 104.396,54.477 104.21,54.29L104.2,54.24ZM42,78.57C42.688,79.26 43.075,80.195 43.075,81.169C43.075,83.188 41.414,84.849 39.395,84.849C37.376,84.849 35.715,83.188 35.715,81.169C35.715,80.195 36.102,79.26 36.79,78.57C38.22,77.144 40.57,77.144 42,78.57ZM41.29,79.28C40.787,78.769 40.099,78.482 39.382,78.482C37.912,78.482 36.702,79.692 36.702,81.162C36.702,81.879 36.989,82.567 37.5,83.07C38.555,84.074 40.235,84.074 41.29,83.07C42.323,82.019 42.309,80.305 41.26,79.27L41.29,79.28ZM17,20C18.097,20 19,20.903 19,22C19,23.097 18.097,24 17,24C15.903,24 15,23.097 15,22C15,20.903 15.903,20 17,20ZM17,21C16.451,21 16,21.451 16,22C16,22.549 16.451,23 17,23C17.549,23 18,22.549 18,22C18,21.451 17.549,21 17,21ZM23,20C24.097,20 25,20.903 25,22C25,23.097 24.097,24 23,24C21.903,24 21,23.097 21,22C21,20.903 21.903,20 23,20ZM23,21C22.451,21 22,21.451 22,22C22,22.549 22.451,23 23,23C23.549,23 24,22.549 24,22C24,21.451 23.549,21 23,21ZM11,20C12.097,20 13,20.903 13,22C13,23.097 12.097,24 11,24C9.903,24 9,23.097 9,22C9,20.903 9.903,20 11,20ZM11,21C10.451,21 10,21.451 10,22C10,22.549 10.451,23 11,23C11.549,23 12,22.549 12,22C12,21.451 11.549,21 11,21ZM10,35.71C10.113,35.959 10.41,36.072 10.66,35.96L15.43,33.76C15.741,33.639 15.947,33.338 15.947,33.005C15.947,32.672 15.741,32.371 15.43,32.25L10.71,30C10.644,29.97 10.573,29.954 10.5,29.954C10.225,29.954 9.999,30.18 9.999,30.455C9.999,30.65 10.113,30.828 10.29,30.91L14.72,32.91L10.29,34.91C10.059,34.958 9.892,35.164 9.892,35.4C9.892,35.512 9.93,35.622 10,35.71ZM62,14.15C62.088,14.149 62.174,14.125 62.25,14.08L64.02,13.08C64.176,12.991 64.272,12.824 64.272,12.645C64.272,12.37 64.045,12.143 63.77,12.143C63.682,12.143 63.596,12.166 63.52,12.21L61.75,13.21C61.598,13.3 61.505,13.464 61.505,13.64C61.505,13.912 61.728,14.137 62,14.14L62,14.15ZM23,54.5C23,54.226 22.774,54 22.5,54L9.08,54C7.939,54 7,53.061 7,51.92L7,51L22.5,51C22.774,51 23,50.774 23,50.5C23,50.226 22.774,50 22.5,50L7,50L7,27L33.5,27C33.774,27 34,26.774 34,26.5C34,26.226 33.774,26 33.5,26L7,26L7,20.08C7,18.939 7.939,18 9.08,18L47.92,18C48.22,17.999 48.517,18.064 48.79,18.19C48.856,18.22 48.927,18.236 49,18.236C49.275,18.236 49.501,18.01 49.501,17.735C49.501,17.54 49.387,17.362 49.21,17.28C48.806,17.094 48.365,16.998 47.92,17L9.08,17C7.39,17 6,18.39 6,20.08L6,51.92C6,53.61 7.39,55 9.08,55L22.5,55C22.774,55 23,54.774 23,54.5ZM50.09,54.73C50.017,54.691 49.936,54.671 49.854,54.671C49.579,54.671 49.354,54.896 49.354,55.171C49.354,55.322 49.422,55.465 49.54,55.56C51.01,56.56 53.85,58.77 59.02,63.94C62.53,67.45 66.02,71.22 69.02,74.84C69.115,74.951 69.254,75.015 69.4,75.015C69.674,75.015 69.9,74.789 69.9,74.515C69.9,74.396 69.857,74.281 69.78,74.19C66.7,70.55 63.21,66.77 59.68,63.19C56.74,60.089 53.531,57.254 50.09,54.72L50.09,54.73ZM2.65,50.21C1.633,49.623 1.003,48.535 1,47.36L1,18.65C1.001,17.472 1.631,16.381 2.65,15.79L27.51,1.44C28.529,0.847 29.791,0.847 30.81,1.44L52.68,14.08C52.756,14.124 52.842,14.147 52.93,14.147C53.205,14.147 53.432,13.92 53.432,13.645C53.432,13.466 53.336,13.299 53.18,13.21L31.31,0.57C29.98,-0.193 28.34,-0.193 27.01,0.57L2.15,14.92C0.821,15.69 -0,17.114 -0,18.65L0,47.36C0.003,48.892 0.824,50.312 2.15,51.08C2.226,51.124 2.312,51.147 2.4,51.147C2.675,51.147 2.902,50.92 2.902,50.645C2.902,50.466 2.806,50.299 2.65,50.21ZM16.5,36L20.5,36C20.774,36 21,35.774 21,35.5C21,35.226 20.774,35 20.5,35L16.5,35C16.226,35 16,35.226 16,35.5C16,35.774 16.226,36 16.5,36ZM67,83.08L59.12,87.58C58.104,88.157 56.856,88.157 55.84,87.58L48.92,83.58C48.844,83.536 48.758,83.513 48.67,83.513C48.395,83.513 48.168,83.74 48.168,84.015C48.168,84.194 48.264,84.361 48.42,84.45L55.34,88.45C56.659,89.2 58.281,89.2 59.6,88.45L67.48,83.95C67.636,83.861 67.732,83.694 67.732,83.515C67.732,83.24 67.505,83.013 67.23,83.013C67.142,83.013 67.056,83.036 66.98,83.08L67,83.08ZM38.28,42.33C37.446,42.202 36.627,41.984 35.84,41.68C35.793,41.666 35.744,41.658 35.694,41.658C35.42,41.658 35.194,41.884 35.194,42.158C35.194,42.343 35.297,42.513 35.46,42.6C36.315,42.932 37.203,43.171 38.11,43.31C39.258,43.384 40.348,43.846 41.2,44.62C42.057,45.423 42.49,46.582 42.37,47.75C42.366,47.775 42.364,47.8 42.364,47.826C42.364,48.072 42.546,48.283 42.79,48.32L42.87,48.32C43.113,48.318 43.321,48.14 43.36,47.9C43.531,46.414 42.993,44.931 41.91,43.9C40.912,42.982 39.632,42.428 38.28,42.33ZM65,8.5C65,5.483 67.483,3 70.5,3C73.517,3 76,5.483 76,8.5C76,11.517 73.517,14 70.5,14C67.485,13.995 65.005,11.515 65,8.5ZM66,8.5C66,10.969 68.031,13 70.5,13C72.969,13 75,10.969 75,8.5C75,6.031 72.969,4 70.5,4C68.033,4.005 66.005,6.033 66,8.5ZM23.25,62.12L14.25,56.89C14.174,56.846 14.088,56.823 14,56.823C13.725,56.823 13.498,57.05 13.498,57.325C13.498,57.504 13.594,57.671 13.75,57.76L22.75,62.99C22.826,63.035 22.912,63.06 23,63.06C23.272,63.057 23.495,62.832 23.495,62.56C23.495,62.384 23.402,62.22 23.25,62.13L23.25,62.12ZM55.69,72.33C55.596,72.235 55.468,72.182 55.335,72.182C55.202,72.182 55.074,72.235 54.98,72.33L46.21,81.11C46.206,80.107 45.981,79.116 45.55,78.21C45.475,78.019 45.29,77.893 45.085,77.893C44.81,77.893 44.585,78.118 44.585,78.393C44.585,78.479 44.607,78.565 44.65,78.64C45.694,80.842 45.262,83.476 43.57,85.23C42.386,86.344 40.815,86.957 39.19,86.94C37.645,86.94 36.164,86.312 35.09,85.2C32.916,82.9 32.97,79.236 35.21,77C36.964,75.251 39.642,74.79 41.88,75.85C41.938,75.873 42,75.885 42.063,75.885C42.337,75.885 42.563,75.659 42.563,75.385C42.563,75.205 42.466,75.039 42.31,74.95C41.404,74.52 40.413,74.294 39.41,74.29L48.58,65.12C48.674,65.026 48.727,64.898 48.727,64.765C48.727,64.49 48.5,64.263 48.225,64.263C48.092,64.263 47.964,64.316 47.87,64.41L37.87,74.41L37.87,74.46C34.753,75.159 32.518,77.95 32.518,81.144C32.518,82.899 33.192,84.588 34.4,85.86C35.666,87.15 37.403,87.872 39.21,87.86L39.3,87.86C41.094,87.856 42.826,87.19 44.16,85.99L44.24,85.94L44.31,85.86L44.43,85.75C44.471,85.71 44.505,85.662 44.53,85.61C45.286,84.754 45.815,83.723 46.07,82.61L46.12,82.61L55.69,73C55.861,72.811 55.861,72.519 55.69,72.33Z" style="fill:rgb(91,192,255);fill-rule:nonzero;"/>
            <path d="M23.5,60.82L23.5,63.18C23.5,63.181 23.5,63.182 23.5,63.183C23.5,63.523 23.22,63.803 22.88,63.803C22.771,63.803 22.664,63.774 22.57,63.72L14.63,59.15C14.525,59.087 14.46,58.973 14.46,58.85C14.46,58.662 14.612,58.505 14.8,58.5L21.16,58.5C21.163,58.5 21.167,58.5 21.17,58.5C22.444,58.5 23.495,59.546 23.5,60.82ZM49.26,17.54C49.492,17.604 49.739,17.576 49.95,17.46L51.84,16.38L31.24,4.53C30.004,3.816 28.476,3.816 27.24,4.53L2.51,18.77C1.275,19.483 0.511,20.804 0.51,22.23L0.51,47.68C0.511,49.106 1.275,50.427 2.51,51.14L3.05,51.45L3.27,51.58L3.43,51.58C3.433,51.58 3.437,51.58 3.44,51.58C3.748,51.58 4,51.327 4,51.02C4,51.013 4,51.007 4,51L4,22.5C4.005,19.693 6.313,17.385 9.12,17.38L48,17.38C48.425,17.376 48.849,17.43 49.26,17.54ZM89.05,37.94L59.41,21C58.855,20.683 58.229,20.511 57.59,20.5L57.41,20.5C56.77,20.503 56.142,20.675 55.59,21L25.95,38C25.672,38.161 25.5,38.459 25.5,38.78L25.5,74.28C25.498,74.602 25.67,74.901 25.95,75.06L32.05,78.55C32.424,78.773 32.911,78.683 33.18,78.34C33.32,78.17 33.45,78 33.6,77.84L33.6,77.24L34.21,77.24C35.075,76.472 36.1,75.905 37.21,75.58C37.35,75.539 37.477,75.463 37.58,75.36L47.75,65.18C48.061,64.835 48.061,64.305 47.75,63.96C46.782,62.834 45.89,61.645 45.08,60.4C44.94,60.18 44.81,59.98 44.7,59.78C44.302,59.094 43.99,58.362 43.77,57.6C43.733,57.45 43.657,57.312 43.55,57.2L42,55.64C41.799,55.437 41.512,55.343 41.23,55.39C40.974,55.405 40.716,55.405 40.46,55.39C38.345,55.353 36.325,54.496 34.83,53C32.585,50.611 31.051,47.643 30.4,44.43C29.65,40.82 30.23,37.74 32,35.97C32.467,35.413 33.217,35.175 33.92,35.36C34.593,35.651 35.023,36.327 35,37.06C35.1,38.103 35.589,39.071 36.37,39.77C37.156,40.439 38.139,40.833 39.17,40.89C41.165,41.098 43.035,41.968 44.48,43.36C46.206,45.03 47.076,47.4 46.84,49.79C46.802,50.065 46.894,50.343 47.09,50.54L48.64,52.1C48.756,52.208 48.897,52.287 49.05,52.33C50.89,52.955 52.59,53.937 54.05,55.22C54.47,55.55 54.92,55.92 55.39,56.31C55.729,56.625 56.261,56.625 56.6,56.31L58.88,54L60.39,52.49C60.608,52.282 60.703,51.975 60.64,51.68C60.64,51.5 60.54,51.27 60.46,50.97L60.35,50.58C59.9,48.949 59.852,47.233 60.21,45.58C60.579,43.912 61.419,42.385 62.63,41.18L65.7,38.1C67.69,36.179 70.539,35.421 73.22,36.1L75.22,36.65C75.851,36.831 76.328,37.355 76.45,38C76.611,38.596 76.439,39.235 76,39.67L69.73,45.94C69.482,46.18 69.399,46.546 69.52,46.87L71,51C71.088,51.259 71.291,51.462 71.55,51.55L75.7,53.03C76.028,53.14 76.391,53.059 76.64,52.82L82.93,46.54C83.254,46.217 83.693,46.036 84.151,46.036C84.929,46.036 85.615,46.56 85.82,47.31L86.37,49.31C87.046,51.982 86.309,54.823 84.42,56.83L80.42,60.83C78.727,62.484 76.322,63.199 74,62.74L73.63,62.66L71.85,62.19C71.521,62.097 71.187,62.02 70.85,61.96C70.565,61.915 70.276,62.008 70.07,62.21L66.54,65.75C66.206,66.097 66.206,66.653 66.54,67C70.27,71 73.77,75 76.54,78.56C77.09,79.26 77.54,79.91 78.03,80.56C78.299,80.927 78.808,81.031 79.2,80.8L89.2,75.1C89.48,74.941 89.652,74.642 89.65,74.32L89.65,38.72C89.622,38.365 89.386,38.058 89.05,37.94ZM59.38,76.61C58.48,75.781 57.068,75.807 56.2,76.67L47.93,84.95C47.5,85.62 47.53,85.95 48.12,86.36L57.05,91.47C57.328,91.631 57.672,91.631 57.95,91.47C59.61,90.47 65.52,87.14 68.02,85.71C68.3,85.55 68.473,85.251 68.473,84.929C68.473,84.658 68.35,84.401 68.14,84.23C65.08,81.75 61.95,79 59.38,76.61ZM114.5,22.23L114.5,49.68C114.499,51.106 113.735,52.427 112.5,53.14L107.4,56.08C107.296,56.139 107.179,56.169 107.06,56.169C106.757,56.169 106.488,55.97 106.4,55.68C106.045,54.379 104.854,53.469 103.506,53.469C103.127,53.469 102.752,53.54 102.4,53.68C102.492,53.448 102.539,53.2 102.54,52.95C102.54,51.853 101.637,50.95 100.54,50.95C101.637,50.95 102.54,50.047 102.54,48.95C102.54,47.853 101.637,46.95 100.54,46.95C99.443,46.95 98.54,47.853 98.54,48.95C98.54,50.047 99.443,50.95 100.54,50.95C99.443,50.95 98.54,51.853 98.54,52.95C98.541,53.2 98.588,53.448 98.68,53.68C97.443,53.171 96.007,53.548 95.18,54.6C94.258,55.849 94.409,57.607 95.53,58.68L96.3,59.45L95.42,60.33C94.706,61.02 94.38,62.022 94.55,63C94.593,63.273 94.456,63.544 94.21,63.67L93.21,64.26C93.116,64.305 93.014,64.328 92.91,64.328C92.534,64.328 92.222,64.025 92.21,63.65L92.21,37.33C92.188,34.854 90.854,32.568 88.71,31.33L63.05,16.67C62.989,16.638 62.934,16.593 62.89,16.54L66.05,14.72C67.249,15.863 68.844,16.502 70.501,16.502C72.676,16.502 74.71,15.401 75.9,13.58C76.905,12.099 77.239,10.26 76.82,8.52L83.76,4.52C84.996,3.806 86.524,3.806 87.76,4.52L94.4,8.34C93.842,8.708 93.503,9.332 93.5,10C93.5,8.903 92.597,8 91.5,8C90.403,8 89.5,8.903 89.5,10C89.5,8.903 88.597,8 87.5,8C86.403,8 85.5,8.903 85.5,10C85.5,8.903 84.597,8 83.5,8C82.403,8 81.5,8.903 81.5,10C81.5,8.903 80.597,8 79.5,8C78.403,8 77.5,8.903 77.5,10C77.5,11.097 78.403,12 79.5,12C80.597,12 81.5,11.097 81.5,10C81.5,11.097 82.403,12 83.5,12C84.597,12 85.5,11.097 85.5,10C85.5,11.097 86.403,12 87.5,12C88.597,12 89.5,11.097 89.5,10C89.5,11.097 90.403,12 91.5,12C92.597,12 93.5,11.097 93.5,10C93.5,10.008 93.5,10.016 93.5,10.024C93.5,11.122 94.403,12.024 95.5,12.024C96.414,12.024 97.218,11.397 97.44,10.51C97.44,10.477 97.467,10.45 97.5,10.45C97.533,10.45 97.56,10.477 97.56,10.51C97.791,11.388 98.592,12.003 99.5,12C99.803,12.004 100.102,11.932 100.37,11.79L106.47,15.31C106.476,15.417 106.476,15.523 106.47,15.63C106.543,16.674 107.424,17.493 108.47,17.49L108.61,17.49C108.97,17.462 109.315,17.338 109.61,17.13L112.45,18.76C113.147,19.155 113.706,19.756 114.05,20.48C114.337,21.019 114.491,21.619 114.5,22.23ZM102.6,22.12C102.867,22.942 103.638,23.503 104.503,23.503C105.25,23.503 105.937,23.084 106.28,22.42C106.497,22.001 106.554,21.518 106.44,21.06C106.74,21.249 107.086,21.353 107.44,21.36C108.092,21.361 108.705,21.043 109.08,20.51L109.27,20.24L109.27,20.17C109.432,19.799 109.481,19.388 109.41,18.99C109.308,18.467 109.002,18.006 108.56,17.71C108.229,17.487 107.839,17.367 107.44,17.367C106.343,17.367 105.44,18.27 105.44,19.367C105.44,19.482 105.45,19.597 105.47,19.71C105.161,19.526 104.807,19.428 104.447,19.428C103.692,19.428 102.999,19.856 102.66,20.53C102.414,21.027 102.392,21.606 102.6,22.12ZM90.5,22C90.5,23.097 91.403,24 92.5,24C93.597,24 94.5,23.097 94.5,22C94.5,23.097 95.403,24 96.5,24C97.597,24 98.5,23.097 98.5,22C98.5,23.097 99.403,24 100.5,24C101.597,24 102.5,23.097 102.5,22C102.5,20.903 101.597,20 100.5,20C99.403,20 98.5,20.903 98.5,22C98.5,20.903 97.597,20 96.5,20C95.403,20 94.5,20.903 94.5,22C94.5,20.903 93.597,20 92.5,20C91.403,20 90.5,20.903 90.5,22C90.5,20.903 89.597,20 88.5,20C87.403,20 86.5,20.903 86.5,22C86.5,20.903 85.597,20 84.5,20C83.403,20 82.5,20.903 82.5,22C82.5,20.903 81.597,20 80.5,20C79.403,20 78.5,20.903 78.5,22C78.501,21.828 78.478,21.656 78.43,21.49C78.148,20.437 77.055,19.799 76,20.07C74.939,20.343 74.29,21.439 74.56,22.5C74.788,23.381 75.59,24.002 76.5,24C76.683,24 76.865,23.973 77.04,23.92C77.899,23.679 78.497,22.892 78.5,22C78.5,23.097 79.403,24 80.5,24C81.597,24 82.5,23.097 82.5,22C82.5,23.097 83.403,24 84.5,24C85.597,24 86.5,23.097 86.5,22C86.5,23.097 87.403,24 88.5,24C89.597,24 90.5,23.097 90.5,22ZM99.15,29.9C99.646,29.729 100.056,29.37 100.29,28.9C100.425,28.63 100.497,28.332 100.5,28.03C100.502,28.245 100.539,28.458 100.61,28.66C100.888,29.464 101.65,30.007 102.5,30.007C103.257,30.007 103.952,29.577 104.29,28.9C104.526,28.431 104.562,27.886 104.39,27.39C104.112,26.586 103.35,26.043 102.5,26.043C101.415,26.043 100.518,26.926 100.5,28.01C100.498,27.799 100.461,27.589 100.39,27.39C100.112,26.586 99.35,26.043 98.5,26.043C97.419,26.043 96.523,26.919 96.5,28C96.502,27.789 96.468,27.58 96.4,27.38C96.129,26.565 95.361,26.011 94.502,26.011C94.28,26.011 94.06,26.048 93.85,26.12C92.948,26.435 92.391,27.354 92.53,28.3L92.37,28.21C91.891,27.981 91.34,27.953 90.84,28.13C90.344,28.301 89.934,28.66 89.7,29.13C89.228,30.112 89.642,31.309 90.62,31.79C90.891,31.92 91.187,31.988 91.488,31.988C92.281,31.988 93.002,31.516 93.32,30.79C93.486,30.431 93.542,30.031 93.48,29.64C93.781,29.827 94.126,29.93 94.48,29.94C94.701,29.944 94.921,29.91 95.13,29.84C95.63,29.672 96.044,29.312 96.28,28.84C96.41,28.565 96.478,28.264 96.48,27.96C96.48,27.963 96.48,27.966 96.48,27.969C96.48,29.066 97.383,29.969 98.48,29.969C98.701,29.969 98.921,29.932 99.13,29.86L99.15,29.9ZM101.23,43.06C100.996,42.968 100.747,42.92 100.495,42.92C99.398,42.92 98.495,43.823 98.495,44.92C98.495,46.017 99.398,46.92 100.495,46.92C100.497,46.92 100.498,46.92 100.5,46.92C101.595,46.917 102.495,46.015 102.495,44.92C102.495,44.101 101.992,43.361 101.23,43.06ZM105.46,41.6C105.268,40.658 104.422,39.981 103.46,40C103.327,39.985 103.193,39.985 103.06,40C102.546,40.104 102.094,40.406 101.8,40.84C101.499,41.278 101.39,41.82 101.5,42.34C101.684,43.29 102.532,43.978 103.5,43.96L103.9,43.96C104.419,43.856 104.876,43.55 105.17,43.11C105.464,42.666 105.568,42.122 105.46,41.6ZM108.89,38.6C108.518,38.243 108.021,38.043 107.505,38.043C106.96,38.043 106.437,38.266 106.06,38.66C105.29,39.435 105.29,40.705 106.06,41.48C106.428,41.849 106.929,42.054 107.45,42.05C107.988,42.05 108.504,41.834 108.88,41.45C109.28,41.072 109.508,40.546 109.508,39.995C109.508,39.45 109.284,38.927 108.89,38.55L108.89,38.6ZM108.5,34C109.597,34 110.5,33.097 110.5,32C110.5,30.903 109.597,30 108.5,30L108.2,30C108.749,29.097 108.492,27.907 107.62,27.31C107.289,27.086 106.899,26.967 106.499,26.967C105.834,26.967 105.211,27.298 104.84,27.85C104.616,28.181 104.497,28.571 104.497,28.971C104.497,29.636 104.828,30.259 105.38,30.63C105.706,30.845 106.089,30.96 106.48,30.96C106.58,30.97 106.68,30.97 106.78,30.96C106.593,31.261 106.49,31.606 106.48,31.96C106.48,33.057 107.383,33.96 108.48,33.96C107.383,33.96 106.48,34.863 106.48,35.96C106.48,37.057 107.383,37.96 108.48,37.96C109.577,37.96 110.48,37.057 110.48,35.96C110.459,34.885 109.575,34.011 108.5,34ZM107.5,68.5C107.403,68.507 107.307,68.507 107.21,68.5L107.5,68.79L107.79,68.5L107.5,68.5Z" style="fill:rgb(91,192,255);fill-opacity:0.2;fill-rule:nonzero;"/>
        </g>
    </svg>
    <div class="second">
      <h1>Asset Portal</h1>
      <p>
        Whether you're looking for extensions, pathfinders, sprite sets, example
        projects or code snippets—you name it, we've got it!
      </p>
    </div>
    <div class="last">
      <vscode-button>
        <a class="button secondary" target="_blank" href="https://defold.com/submit_asset">Submit asset</a>
      </vscode-button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters">
    {#if tags}
      <p style="margin-bottom: 0">TAGS</p>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); grid-gap: 0 1rem; font-size: 0.9em;">
        {#each tags as tag}
          <!-- svelte-ignore a11y-invalid-attribute -->
          <a href="#" class:active={tag.selected} on:click={(event) => { event.preventDefault(); filterAssetsByTag(tag); }}>
            {tag.name} ({tag.count})
          </a>
        {/each}
      </div>
    {/if}

    <vscode-text-field placeholder="Type to filter..." on:input={(event) => filterAssetsByText(event)}>
      Search
    </vscode-text-field>
  </div>

  <!-- Assets -->
  {#if assets}
    <div class="assets-container">
      {#each assets.filter(x => !x.hidden) as asset}
        <div class="asset">
          <!-- Author -->
          <div class="author">
            <span>{asset.author}</span>
          </div>
          <!-- Image -->
          {#if !asset.images?.thumb}
            <div class="image" style="background: url('https://defold.com/images/asset-nothumb.jpg') center/cover"/>
          {:else if asset.images.thumb.startsWith("http")}
            <div class="image" style="background: url('{asset.images.thumb}') center/cover"/>
          {:else}
            <div class="image" style="background: url('https://raw.githubusercontent.com/defold/asset-portal/master/assets/images/{asset.images.thumb}') center/cover"/>
          {/if}
          <!-- Title -->
          <div class="title">
            <div>
              <b>
                <a href={asset.project_url} target="_blank" style="color: inherit">
                  {asset.name}
                </a>
              </b>
              <p class="tags">
                {asset.tags.join(", ")}
              </p>
            </div>
            {#if asset.stars}
              <div class="stars-container">
                <p class="right">
                  <span class="octicon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16">
            <path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"/>
          </svg>
                  </span>
                  {asset.stars}
                </p>
              </div>
            {/if}
          </div>
          <!-- Description -->
          <div class="description">
            {asset.description}
          </div>
          <!-- Controls -->
          <div class="controls">
            <div class="buttons">
              <vscode-button on:click={() => addDependencyToProject(asset)}>Add to project</vscode-button>
              <!-- <vscode-button on:click={() => copyFilesIntoProject(asset)}>Copy files</vscode-button> -->
            </div>
          </div>
        </div>
      {/each}
    </div>
  {/if}
</main>

<style>
  main {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    height: 100%;

    max-width: 1200px;
    margin: 0 auto;
  }

  /**********
	*  header *
	**********/
  .header {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin: 1em 0;
    width: 100%;
  }

  .header > .second {
    margin: 0 3em;
  }

  .header > .last {
    display: flex;
    align-self: flex-start;
    margin-top: 20px;
    width: 150px;
    height: 39px;
  }

  .header > .last vscode-button {
    width: 100%;
    height: 100%;
  }

  vscode-button a {
    color: inherit;
    text-decoration: none;
  }

  /***********
	*  filters *
	***********/

  .filters {
    width: 100%;
    margin-top: 1em;
    margin-bottom: 2em;
  }

  .filters a {
    color: inherit;
    font-size: 0.9em;
  }

  .filters a.active {
    font-weight: bold;
    color: white;
  }

  .filters vscode-text-field {
    margin-top: 1em;
  }

  /**********
	*  assets *
	**********/

  p {
    margin-top: 0;
  }

  .right {
    text-align: right;
  }

  /* take full screen with content centered with flex */
  .loader {
    width: 100%;
    height: 100%;
    position: fixed;
    top: 0;
    left: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: var(--vscode-editor-background);
    z-index: 1000;
  }

  .loader vscode-progress-ring {
    width: 10%;
    height: 10%;
    margin: 10px;
  }

  .assets-container {
    display: grid;
    grid-template-columns: repeat(4, minmax(250px, 350px));
    grid-gap: 1.3em;
    padding: 0px;
  }
  @media (max-width: 1100px) {
    .assets-container {
      grid-template-columns: repeat(3, minmax(250px, 350px));
    }
  }
  @media (max-width: 800px) {
    .assets-container {
      grid-template-columns: repeat(2, minmax(200px, 400px));
    }
  }

  .asset {
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
    margin-bottom: 0;
    border-radius: 4px;
    background-color: var(--grey);
  }

  .asset .author {
    position: relative;
    padding: 0em;
    color: #eee;
    cursor: default;
  }

  .asset .author > * {
    position: absolute;
    top: 5px;
    right: 8px;
    text-shadow: 1px 1px 1px black, -1px 1px 1px black, 1px -1px 1px black,
      -1px -1px 1px black;
  }

  .asset .image {
    padding: 0;
    margin: 0;
    height: 190px;
    border-radius: 4px 4px 0 0;
  }

  .asset .title {
    display: grid;
    grid-template-columns: 70% auto;
    grid-gap: 0;
  }

  .asset .stars-container .octicon {
    fill: #daaa3f;
    vertical-align: middle;
    margin-right: 2px;
  }

  .asset .tags {
    font-size: smaller;
    margin-bottom: 0px;
  }

  .asset .description {
    font-size: smaller;
    margin-bottom: 0;
  }

  .asset .controls {
    padding-top: 0.5em;
    padding-left: 0;
    width: 100%;
    display: flex;
    flex-grow: 1;
    align-items: end;
  }

  .asset .controls .buttons {
    width: 100%;
    display: flex;
    justify-content: space-between;
  }

  .asset .controls vscode-button {
    width: 100%;
    min-height: 30px;
  }

  .asset .title,
  .asset .description {
    padding-left: 1em;
    padding-right: 1em;
    padding-top: 1em;
    padding-bottom: 0;
  }
</style>
